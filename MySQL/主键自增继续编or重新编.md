# 主键自增继续编or重新编

问题场景：

MySQL中带有自增键，删除部分数据后，再将MySQL重启后，自增键是继续编还是重新编？假设test表中有id1到7的记录，如果删除了id>=5的记录，那么此时test里只有id1到4的记录。请问重启MySQL后，自增id的起始值是5还是8？

- 对于MyISAM来说，新增数据id为8。 

- 对于InnoDB8.0之前的版本来说，新增数据的id为5。对于InnoDB8.0之后的版本新增数据的id为8。 

原理是MyISAM会将最大id记录到数据文件中，重启后会重新读取。InnoDB8.0之前，最大id会记录在内存中，重启之后InnoDB会读取表中最大的id，将id+1作为起始自增id。InnoDB8.0之后它将最大id记录在redolog里了，原理与MyISAM类似，所以不会丢失最大id的信息。  

总结：InnoDB8.0之前并不会把最大自增id持久化。