# ABA

使用版本号。

每次变量更新把版本号加1.

那么，A-B-A------>1A-2B-3A。

所以CAS时不仅要检查值，还要检查版本。

替换时也一样。

java种有个类实现了这个功能。