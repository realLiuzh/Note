# 轻量级锁

优化点：仅仅使用CAS操作来获取锁

## 是否获取锁

如果对象头的MarkWord指向当前线程的栈帧，那么说明当前线程已经获取这个对象的锁。

## 加锁流程

线程用对象头中的Mark Word替换为指向锁记录的指针

- 成功：获取轻量级锁
- 失败：自旋获取锁，达到自旋上限后会膨胀为重量级锁

## 锁撤销

解锁时会使用CAS操作把Mark Word替换到对象头

- 成功，没有竞争产生
- 失败，存在竞争，膨胀为重量级锁